<!DOCTYPE html><html lang='en'><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width,initial-scale=1'><title>Your Cart • Plaques</title><style>body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:#0d1114;color:#eef3f4;}header{display:flex;align-items:center;justify-content:space-between;padding:18px 34px;background:#12181d;border-bottom:1px solid #1f262b;}a{color:#1db954;text-decoration:none;}a:hover{text-decoration:underline;}h1{margin:26px 0 10px;font-size:1.9rem;letter-spacing:-1px;}main{max-width:980px;margin:0 auto;padding:20px clamp(16px,4vw,40px) 80px;}table{width:100%;border-collapse:collapse;margin-top:10px;}th,td{text-align:left;padding:14px 10px;font-size:.8rem;}th{font-size:.65rem;text-transform:uppercase;letter-spacing:.55px;color:#95a8b1;border-bottom:1px solid #223038;}tbody tr{border-bottom:1px solid #1f2a30;}tbody tr:last-child{border-bottom:none;}tfoot td{font-weight:600;}button{cursor:pointer;} .qty-btn{background:#1d262c;border:1px solid #2b3840;color:#c9d6dc;padding:4px 10px;border-radius:6px;font-size:.75rem;font-weight:600;} .qty-btn:hover{background:#253238;} .remove{background:none;border:none;color:#6b7d86;font-size:.65rem;font-weight:600;letter-spacing:.5px;text-transform:uppercase;cursor:pointer;} .remove:hover{color:#ff7272;} .empty{padding:70px 0;font-size:.9rem;color:#8fa2aa;text-align:center;} .summary{margin-top:40px;display:flex;flex-direction:column;gap:12px;max-width:420px;} .code-line{display:flex;gap:8px;} .code-line input{flex:1;background:#121a20;border:1px solid #233139;color:#dfe8ea;padding:10px 12px 9px;border-radius:9px;font-size:.8rem;} .apply{background:#1db954;color:#052815;border:1px solid #0e321c;font-size:.7rem;font-weight:600;padding:10px 14px 9px;border-radius:9px;letter-spacing:.5px;} .apply:hover{filter:brightness(1.07);} .checkout{margin-top:16px;background:linear-gradient(140deg,#1db954,#1ed760);border:1px solid #0f2f19;color:#052813;font-size:.9rem;font-weight:600;padding:16px 26px 15px;border-radius:14px;letter-spacing:.6px;box-shadow:0 8px 22px -10px rgba(0,0,0,.65),0 0 0 1px rgba(0,0,0,.55) inset;} .checkout:active{transform:translateY(2px);} footer{padding:60px 0 50px;text-align:center;font-size:.6rem;color:#6e818b;} .badge{display:inline-block;background:#1db954;color:#062b16;font-size:.55rem;padding:4px 6px 3px;border-radius:6px;margin-left:6px;}</style></head><body><header><div style='font-weight:700'>Plaques</div><nav><a href='/shop.html'>Shop</a> <a href='/index.html'>Designer</a></nav></header><main><h1>Your Cart</h1><div id='cartContainer'></div><div class='summary' id='summary' style='display:none'><div style='font-size:.7rem;font-weight:600;letter-spacing:.5px;color:#7d909a;text-transform:uppercase;'>Promo Codes</div><div class='code-line'><input id='codeInput' placeholder='Enter code'><button class='apply' id='applyCode'>Apply</button></div><div id='appliedCodes' style='display:flex;gap:6px;flex-wrap:wrap;'></div><div style='margin-top:6px;font-size:.8rem;color:#8fa2ac;' id='subtotalLine'></div><div style='font-size:1.4rem;font-weight:700;' id='totalLine'></div><button class='checkout' id='checkoutBtn'>Checkout</button><div id='checkoutStatus' style='font-size:.7rem;color:#90a2ac;'></div></div></main><footer>&copy; <span id='year'></span> Campus Plaques • Student focused.</footer><script>const API_BASE=location.origin.replace(/\/$/,'')+'/api';const cart=JSON.parse(localStorage.getItem('plaque-cart')||'[]');function save(){localStorage.setItem('plaque-cart',JSON.stringify(cart));}function fetchProducts(){return fetch(API_BASE+'/products').then(r=>r.json()).then(j=>j.products);}let catalog=[];let codes=[];function priceEstimate(sel){return fetch(API_BASE+'/price-estimate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({selection:sel,codes})}).then(r=>r.json());}function render(){const wrap=document.getElementById('cartContainer'); if(!cart.length){wrap.innerHTML="<div class='empty'>Your cart is empty. <a href='/shop.html'>Shop plaques</a>.</div>";document.getElementById('summary').style.display='none';return;} document.getElementById('summary').style.display='flex'; let rows=""; cart.forEach(item=>{ const prod=catalog.find(p=>p.id===item.id); if(!prod) return; const sel=item.sel||{}; const optTxt=Object.entries(sel).map(([k,v])=>`${k}: ${v}`).join(', '); rows+=`<tr data-id='${item.id}' data-sel='${btoa(JSON.stringify(sel))}'><td style='font-weight:600;font-size:.75rem;letter-spacing:.4px;'>${prod.name}<div style='color:#7f919b;font-weight:500;margin-top:4px;'>${optTxt||'Default options'}</div></td><td><button class='qty-btn dec'>-</button> <span class='q'>${item.qty}</span> <button class='qty-btn inc'>+</button></td><td class='line' style='font-weight:600;'>--</td><td><button class='remove'>Remove</button></td></tr>`; }); wrap.innerHTML=`<table><thead><tr><th>Item</th><th>Qty</th><th>Price</th><th></th></tr></thead><tbody>${rows}</tbody></table>`; updatePrices();}
function key(item){return item.id+':'+JSON.stringify(item.sel||{});}function updatePrices(){const rows=[...document.querySelectorAll('tbody tr')];Promise.all(rows.map(r=>{const sel=JSON.parse(atob(r.dataset.sel));return priceEstimate(sel).then(j=>({row:r,price:j.total}));})).then(list=>{let subtotal=0;list.forEach(({row,price})=>{const q=parseInt(row.querySelector('.q').textContent,10); const line=price*q; subtotal+=line; row.querySelector('.line').textContent='$'+line.toFixed(2);}); document.getElementById('subtotalLine').textContent='Subtotal $'+subtotal.toFixed(2); const codePart=codes.length?(' • Codes: '+codes.join(', ')):''; // final total with discounts applied once globally already estimated per line; to simplify apply codes on subtotal now
 fetch(API_BASE+'/price-estimate',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ selection:{}, codes })}).then(r=>r.json()).then(j=>{document.getElementById('totalLine').textContent='Total $'+(subtotal + (j.total - j.basePrice)).toFixed(2)+codePart;});});}
addEventListener('click',e=>{ if(e.target.classList.contains('inc')||e.target.classList.contains('dec')){ const tr=e.target.closest('tr'); const id=tr.dataset.id; const sel=JSON.parse(atob(tr.dataset.sel)); const item=cart.find(i=>i.id===id && JSON.stringify(i.sel)==JSON.stringify(sel)); if(!item) return; if(e.target.classList.contains('inc')) item.qty++; else item.qty=Math.max(1,item.qty-1); tr.querySelector('.q').textContent=item.qty; save(); updatePrices(); } else if(e.target.classList.contains('remove')){ const tr=e.target.closest('tr'); const id=tr.dataset.id; const sel=JSON.parse(atob(tr.dataset.sel)); const idx=cart.findIndex(i=>i.id===id && JSON.stringify(i.sel)==JSON.stringify(sel)); if(idx>-1){ cart.splice(idx,1); save(); render(); } } });
 document.getElementById('applyCode').addEventListener('click',()=>{ const code=document.getElementById('codeInput').value.trim(); if(!code) return; if(!codes.includes(code.toUpperCase())) codes.push(code.toUpperCase()); document.getElementById('codeInput').value=''; renderCodes(); updatePrices(); });
 function renderCodes(){ const wrap=document.getElementById('appliedCodes'); wrap.innerHTML=''; codes.forEach(c=>{ const span=document.createElement('span'); span.className='badge'; span.textContent=c; span.title='Click to remove'; span.style.cursor='pointer'; span.onclick=()=>{ codes.splice(codes.indexOf(c),1); renderCodes(); updatePrices(); }; wrap.appendChild(span); }); }
 document.getElementById('checkoutBtn').addEventListener('click',()=>{ const status=document.getElementById('checkoutStatus'); status.textContent='Placing order...'; const orderLines=cart.map(i=>({ id:i.id, sel:i.sel, qty:i.qty })); fetch(API_BASE+'/checkout',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({ selection:{}, codes, customer:{ email:'student@example.edu' }, cart:orderLines })}).then(r=>r.json()).then(j=>{ if(j.success){ status.textContent='Order placed: '+j.order.id; cart.length=0; save(); render(); } else { status.textContent='Error: '+j.error; } }); });
fetchProducts().then(p=>{ catalog=p; render(); }); document.getElementById('year').textContent=new Date().getFullYear();
</script></body></html>
